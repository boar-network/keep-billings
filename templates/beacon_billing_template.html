<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="https://twemoji.maxcdn.com/2/twemoji.min.js?11.2"></script>
        <script>window.onload = function () { twemoji.parse(document.body);}</script>
        <style>
            table {
                width: 100%;
                border-collapse: collapse;
                table-layout: fixed;
            }
    
            table, th, tr, td {
                border: 1px solid gray;
            }
    
            th, td {
                padding: 15px;
                text-align: left;
                word-wrap: break-word
            }
    
            .top-header {
                text-align: center;
            }
    
            .block-number {
                width: 15%;
            }
            .transaction-hash {
                width: 35%;
            }
            .transaction-fee {
                width: 30%;
            }
            .operation {
                width: 20%;
            }
    
            .label-with-legend {
                float: left;
            }
            .legend { 
                float: right;
                text-align: right;
                font-style: italic;
                font-family: monospace;
            }
    
            .final-calculation {
                font-weight: bold;
            }

            img.emoji {
                height: 1em;
                 width: 1em;
                margin: 0 .05em 0 .1em;
                vertical-align: -0.1em;
            }
        </style>
    </head>
   
    <body>
        <header class="top-header">
            <h1>Random Beacon Billing</h1>
            <p>Generated with boar.network <a href="https://github.com/boar-network/keep-billings/">billing tool</a> &#128023;</p>
            <p>Thank you for trusting us with your KEEP &hearts;</p>
        </header>

        <h2>Staker</h2>
        <table>
            <tr>
                <td class="value-name">Name</td>
                <td>{{ .Customer.Name }}</td>
            </tr>
            <tr>
                <td>Stake</td>
                <td>{{ .Stake }} KEEP</td>
            </tr>
            <tr>
                <td>Operator account</td>
                <td>{{ .Customer.Operator }}</td>
            </tr>
            <tr>
                <td>Beneficiary account</td>
                <td>{{ .Customer.Beneficiary }}</td>
            </tr>
            <tr>
                <td>
                    <div class="label-with-legend">Staker net rewards share</div>
                    <div class="legend">RS</div>
                </td>
                <td>{{ .Customer.CustomerSharePercentage }} %</td>
            </tr>
            <tr>
                <td>
                    <div class="label-with-legend">Initial operator account ETH balance</div>
                    <div class="legend">IB</div>
                </td>
                <td>{{ .Customer.InitialOperatorEthBalance }} ETH</td>
            </tr>
        </table>

        <h2>Balances</h2>
        <table>
            <tr>
                <td>
                    <div class="label-with-legend">Current operator account ETH balance</div>
                    <div class="legend">OB</div>
                </td>
                <td>{{ .OperatorBalance }} ETH</td>
            </tr>
            <tr>
                <td>
                    <div class="label-with-legend">Current beneficiary account ETH balance</div>
                    <div class="legend">BB</div>
                </td>
                <td>{{ .BeneficiaryEthBalance }} ETH</td>
            </tr>
            <tr>
                <td>
                    <div class="label-with-legend">Accumulated ETH rewards</div>
                    <div class="legend">AR</div></td>
                <td>{{ .AccumulatedRewards }} ETH</td>
            </tr>
        </table>

        <h2>Rewards</h2>
        <table>
            <tr>
                <td>
                    <div class="label-with-legend final-calculation">Staker ETH earned</div>
                    <div class="legend">(BB+AR-(IB-OB))&times;RS</div>
                </td>
                <td class="final-calculation">{{ .CustomerEthEarned}} ETH</td>
            </tr>
            <tr>
                <td>
                    <div class="label-with-legend final-calculation">Provider ETH earned</div>
                    <div class="legend">(BB+AR-(IB-OB))&times;(1-RS)</div>
                </td>
                <td class="final-calculation">{{ .ProviderEthEarned}} ETH</td>
            </tr>
        </table>

        <h2>Groups</h2>
        <table>
            <tr>
                <td>The number of currently active beacon groups in the network</td>
                <td>{{ .ActiveGroupsCount }}</td>
            </tr>
            <tr>
                <td>The total number of your members in currently active groups</td>
                <td>{{ .ActiveGroupsMembersCount }}</td>
            </tr>
            <tr>
                <td>The total number of your members in no longer active groups</td>
                <td>{{ .InactiveGroupsMembersCount }}</td>
            </tr>
        </table>

        <h2>Group members</h2>

        <table>
            <tr>
                <th>Group</th>
                <th>Members</th>
            </tr>
            {{ range $group, $operatorMembers := .ActiveGroupsSummary }}
                <tr>
                    <td>{{ $group }}</td>
                    <td>{{ $operatorMembers }}</td>
                </tr>
            {{ end }}
        </table>
    </body>
</html>